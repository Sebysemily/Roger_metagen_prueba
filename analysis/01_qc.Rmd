---
title: "01_qc"
author: "Roger Calvas"
date: "`r Sys.Date()`"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      fig.align = "center",
                      fig.path = "figuras/")
knitr::opts_knit$set(
  root.dir = rprojroot::find_rstudio_root_file()
)
```
## Requisitos

envs/01_qc.yml

- NanoPlot
- Filtlong

## Load Packages
```{r load-packages}
library(htmltools)
```

# Goals of file:

1. Cargar secuencias crudas.
2. Analizar la calidad con NanoPlot
3. Correr qc con filtlong 
4. Comprobar calidad postqc con nanoplot

## NanoPlot 1

```{bash NanoPlot 1, eval = FALSE}
conda activate nanoplot 
NanoPlot --version 
NanoPlot 1.44.1
NanoPlot --fastq Data/prueba.fastq.gz --outdir Analysis/01_qc/nanoplot
```

## Resultados pre_qc
```{r NanoPlot-resultados-pre-qc}
cat(readLines("Analysis/01_qc/nanoplot_pre_qc/NanoStats.txt"), sep ="\n")
htmltools::includeHTML("Analysis/01_qc/nanoplot_pre_qc/Yield_By_Length.html")
htmltools::includeHTML("Analysis/01_qc/nanoplot_pre_qc/WeightedHistogramReadlength.html")
htmltools::includeHTML("Analysis/01_qc/nanoplot_pre_qc/LengthvsQualityScatterPlot_kde.html")
```
### Dado los resultados se decidio min calidad de 7 y min largo de 1000

## Filtlong 
```{bash Filtlong, eval = FALSE}
conda deactivate
conda activate filtlong
filtlong --version
Filtlong v0.2.1
filtlong --min_length 1000 --min_mean_q 7 prueba.fastq.gz | gzip > prueba.L1000.Q7.fastq.gz
```

## Nanoplot 2

```{bash NanoPlot 2, eval = FALSE}
conda deactivate
conda activate nanoplot 
NanoPlot --version 
NanoPlot 1.44.1
NanoPlot --fastq Data/prueba.L1000.Q7.fastq.gz --outdir Analysis/01_qc/nanoplotpostqc
```
## resultados post_qc
```{r NanoPlot-resultados-post-qc}
cat(readLines("Analysis/01_qc/nanoplot_post_qc/NanoStats.txt"), sep ="\n")
htmltools::includeHTML("Analysis/01_qc/nanoplot_post_qc/Yield_By_Length.html")
htmltools::includeHTML("Analysis/01_qc/nanoplot_post_qc/WeightedHistogramReadlength.html")
htmltools::includeHTML("Analysis/01_qc/nanoplot_post_qc/LengthvsQualityScatterPlot_kde.html")
```
### Resultados post_qc bla bla 
